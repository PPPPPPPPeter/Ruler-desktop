<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.canvas.Canvas?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<AnchorPane fx:id="mainContainer" xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.example.rulerDesktop.HelloController">
    <children>
        <VBox AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
            <children>
                <!-- Header -->
                <HBox alignment="CENTER_LEFT" prefHeight="50.0" style="-fx-background-color: #2c3e50;" VBox.vgrow="NEVER">
                    <children>
                        <Button fx:id="leftToggleBtn" mnemonicParsing="false" onAction="#toggleLeftSidebar" prefHeight="30.0" prefWidth="30.0" style="-fx-background-color: #34495e; -fx-text-fill: white; -fx-font-size: 16px;" text="▶">
                            <HBox.margin>
                                <Insets left="10.0" />
                            </HBox.margin>
                        </Button>

                        <Label text="Ruler" textFill="WHITE">
                            <font>
                                <Font name="System Bold" size="18.0" />
                            </font>
                            <HBox.margin>
                                <Insets left="20.0" />
                            </HBox.margin>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />

                        <!-- 新增的三个功能按钮 -->
                        <Button fx:id="importCsvBtn" mnemonicParsing="false" onAction="#handleImportCsv" prefHeight="30.0" prefWidth="100.0" style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 15px;" text="Import CSV">
                            <HBox.margin>
                                <Insets right="5.0" />
                            </HBox.margin>
                        </Button>
                        <Button fx:id="exportCsvBtn" mnemonicParsing="false" onAction="#handleExportCsv" prefHeight="30.0" prefWidth="100.0" style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-size: 15px;" text="Export CSV">
                            <HBox.margin>
                                <Insets right="5.0" />
                            </HBox.margin>
                        </Button>
                        <Button fx:id="resetAllBtn" mnemonicParsing="false" onAction="#handleResetAll" prefHeight="30.0" prefWidth="80.0" style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-size: 15px;" text="Reset All">
                            <HBox.margin>
                                <Insets right="10.0" />
                            </HBox.margin>
                        </Button>
                    </children>
                </HBox>

                <!-- 主内容区域 - 包含侧边栏 -->
                <AnchorPane fx:id="contentArea" VBox.vgrow="ALWAYS">
                    <children>
                        <!-- 主内容区域包含滚动功能 -->
                        <ScrollPane fx:id="mainScrollPane" fitToHeight="true" fitToWidth="false" AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0">
                            <content>
                                <VBox fx:id="mainContentContainer" spacing="0.0" style="-fx-background-color: #ecf0f1;">
                                    <children>
                                        <!-- 主要内容区域 -->
                                        <VBox alignment="CENTER" spacing="20.0" style="-fx-background-color: #ecf0f1;" VBox.vgrow="ALWAYS">
                                            <children>
                                                <!-- 未加载CSV时的提示信息 -->
                                                <Label fx:id="noDataLabel" text="No CSV data loaded. Click 'Import CSV' to load a file."
                                                       style="-fx-text-fill: #7f8c8d; -fx-font-size: 18px; -fx-font-weight: bold;"
                                                       visible="true" managed="true" />
                                            </children>
                                            <padding>
                                                <Insets bottom="20.0" left="50.0" right="50.0" top="50.0" />
                                            </padding>
                                        </VBox>
                                        <!-- CSV表格区域 -->
                                        <VBox fx:id="csvTableContainer" prefHeight="190.0" style="-fx-background-color: white; -fx-border-color: #bdc3c7; -fx-border-width: 1 0 0 0;" visible="false" managed="false">
                                            <children>
                                                <!-- 可拖拽的标题栏 -->
                                                <HBox fx:id="csvTableHeader" alignment="CENTER_LEFT" prefHeight="30.0" style="-fx-background-color: #34495e; -fx-cursor: hand;">
                                                    <children>
                                                        <Label fx:id="csvInfoLabel" text="CSV Data Table" textFill="WHITE" style="-fx-font-weight: bold; -fx-font-size: 12px;">
                                                            <HBox.margin>
                                                                <Insets left="10.0" right="10.0" />
                                                            </HBox.margin>
                                                        </Label>
                                                    </children>
                                                </HBox>
                                                <!-- 表格内容区域 -->
                                                <TableView fx:id="csvTableView" VBox.vgrow="ALWAYS" style="-fx-font-size: 12px;" />
                                            </children>
                                        </VBox>
                                    </children>
                                </VBox>
                            </content>
                        </ScrollPane>

                        <!-- 左侧边栏 -->
                        <VBox fx:id="leftSidebar" prefWidth="500.0" style="-fx-background-color: white;"
                              AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.topAnchor="0.0">
                            <children>

                                <!-- 左侧边栏头部带关闭按钮 -->
                                <HBox alignment="CENTER_LEFT" spacing="10.0">
                                    <children>
                                        <Region HBox.hgrow="ALWAYS" />
                                        <Button fx:id="leftCloseBtn" mnemonicParsing="false"
                                                onAction="#closeLeftSidebar" prefHeight="30.0"
                                                prefWidth="30.0" style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-size: 14px;" text="×">
                                        </Button>
                                    </children>
                                    <VBox.margin>
                                        <Insets bottom="10.0" left="20.0" right="20.0" top="20.0" />
                                    </VBox.margin>
                                </HBox>

                                <Separator />

                                <!-- 左侧边栏内容区域 - Matrix组件 -->
                                <VBox spacing="15.0" VBox.vgrow="ALWAYS">
                                    <children>
                                        <!-- Matrix标题和控制 -->
                                        <VBox spacing="10.0">
                                            <children>
                                                <Label text="Sequence Matrix" style="-fx-font-size: 16px; -fx-font-weight: bold;" />

                                                <!-- 列选择和分箱控制 -->
                                                <HBox spacing="10.0" alignment="CENTER_LEFT">
                                                    <children>
                                                        <Label text="Column:" />
                                                        <ComboBox fx:id="matrixColumnComboBox" prefWidth="120.0" onAction="#handleMatrixColumnChange" />
                                                        <Label text="Bins:" />
                                                        <Spinner fx:id="matrixBinSpinner" prefWidth="80.0" min="4" max="12" initialValue="6" />
                                                    </children>
                                                </HBox>

                                                <!-- Matrix信息显示 -->
                                                <Label fx:id="matrixInfoLabel" text="No matrix data"
                                                       style="-fx-font-size: 12px; -fx-text-fill: #666;" />
                                            </children>
                                        </VBox>

                                        <!-- Matrix Canvas容器 -->
                                        <VBox spacing="5.0">
                                            <children>
                                                <!-- Matrix Canvas - 固定250x250 -->
                                                <Canvas fx:id="matrixCanvas" width="250.0" height="250.0"
                                                        style="-fx-border-color: #bdc3c7; -fx-border-width: 1;" />

                                                <!-- Matrix统计信息 -->
                                                <VBox spacing="5.0">
                                                    <children>
                                                        <Label fx:id="matrixStatsLabel" text="Statistics will appear here"
                                                               style="-fx-font-size: 11px; -fx-text-fill: #666;" wrapText="true" />
                                                    </children>
                                                </VBox>
                                            </children>
                                        </VBox>

                                        <!-- Matrix操作按钮 -->
                                        <HBox spacing="10.0" alignment="CENTER_LEFT">
                                            <children>
                                                <Button fx:id="refreshMatrixBtn" text="Refresh" prefWidth="80.0"
                                                        style="-fx-background-color: #3498db; -fx-text-fill: white;"
                                                        onAction="#handleRefreshMatrix" />
                                                <Button fx:id="exportMatrixBtn" text="Export" prefWidth="80.0"
                                                        style="-fx-background-color: #27ae60; -fx-text-fill: white;"
                                                        onAction="#handleExportMatrix" />
                                            </children>
                                        </HBox>
                                    </children>
                                    <VBox.margin>
                                        <Insets left="20.0" right="20.0" top="10.0" />
                                    </VBox.margin>
                                </VBox>
                            </children>
                        </VBox>
                    </children>
                </AnchorPane>


                <!-- Footer -->
                <HBox alignment="CENTER" prefHeight="40.0" style="-fx-background-color: #34495e;" VBox.vgrow="NEVER">
                    <children>
                        <Label text="© 2025 Ruler System - Powered by JavaFX" textFill="WHITE">
                            <font>
                                <Font size="12.0" />
                            </font>
                        </Label>
                    </children>
                </HBox>


            </children>
        </VBox>
    </children>
</AnchorPane>